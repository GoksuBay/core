
pkgname=serf
pkgver=1.3.8
pkgrel=3
pkgdesc="High-performance asynchronous HTTP client library"
url="http://code.google.com/p/serf/"
arch=('x86_64')
license=('Apache')
depends=('apr' 'apr-util' 'openssl' 'zlib')
makedepends=('scons')
options=('!libtool')
source=("http://serf.googlecode.com/svn/src_releases/serf-${pkgver}.tar.bz2"
        'serf-1.3.8-openssl.patch'
        'serf-1.3.8-tests.patch')
md5sums=('2e4efe57ff28cb3202a112e90f0c2889'
         '30af0b6bf39839f3d21327a7a63fac40'
         'cd86cb4302f44f5ef61ec5d3d98a8aca')

build() {
  cd "${srcdir}/${pkgname}-${pkgver}"
  # adding Gentoo patches
  #patch -p1 -i ${srcdir}/serf-1.3.8-openssl.patch
  patch -p1 -i ${srcdir}/serf-1.3.8-tests.patch

  scons PREFIX=/usr GSSAPI=/usr/bin/krb5-config
}

check() {
  cd "${srcdir}/${pkgname}-${pkgver}"

  scons check
}

package() {
  cd "${srcdir}/${pkgname}-${pkgver}"
  install -d "${pkgdir}/usr"
  
  scons PREFIX="${pkgdir}/usr" install
}
